const formContent=document.querySelector(".form__content"),formName=document.querySelector(".form__name"),formAmount=document.querySelector(".form__amount"),formCurrency=document.querySelector(".form__currency"),formBatch=document.querySelector(".form__batch"),formDate=document.querySelector(".form__date"),formRemark=document.querySelector(".form__remark"),formBtn=document.querySelector(".form__button"),formSpinner=document.querySelector(".form__spinner"),checkContent=document.querySelector(".check__content"),checkName=document.querySelector(".check__name"),checkAmount=document.querySelector(".check__amount"),checkBatch=document.querySelector(".check__batch"),checkDate=document.querySelector(".check__date"),checkSN=document.querySelector(".check__SN"),EditBtn=document.querySelector(".check__button.Edit"),SubmitBtn=document.querySelector(".check__button.Submit"),voucher=document.querySelector(".voucher"),voucherName=document.querySelector(".voucher__name"),voucherAmount=document.querySelector(".voucher__amount"),voucherSN=document.querySelector(".voucher__SN"),voucherDate=document.querySelector(".voucher__date"),modal=document.querySelector(".modal"),modalImg=document.querySelector(".modal__img"),download=document.querySelector(".modal__btn");let Name,Amount,Batch,date,SerialNumber,voucherCanvas,Remark="";const url="https://script.google.com/macros/s/AKfycbw3BQmIVOj6PDN32i1WuGeeabg3w0qdE4AI9i_QO0csGyj_spFQmCUh0BHvjUPaO2dT2Q/exec";function collectValues(){Name=formName.value,Amount=formAmount.value,Currency=formCurrency.value,Batch=formBatch.value,date=formDate.value}function putToHTML(){checkName.innerHTML=Name,checkAmount.innerHTML=Amount+" "+Currency,checkBatch.innerHTML=Batch,checkDate.innerHTML=date,checkSN.innerHTML=SerialNumber}function createSN(e){SerialNumber="ECE"+(SerialNumber=e<10?"00000"+e:e<100?"0000"+e:e<1e3?"000"+e:e<1e4?"00"+e:e<1e4?"0"+e:""+e)}function displayCheck(e){e.preventDefault(),collectValues(),formBtn.innerText="Loading...",formBtn.disable=!0,fetch(url).then(e=>e.json()).then(e=>{createSN(e[0].data),console.log("SN  - "+SerialNumber),putToHTML(),formBtn.innerText="Froward",formBtn.disable=!1,formContent.style.display="none",checkContent.style.display="block"})}function displayForm(e){e.preventDefault(),checkContent.style.display="none",formContent.style.display="block"}function screenshot(){html2canvas(document.querySelector(".voucher")).then(function(e){e.className="modal_canvas",e.removeAttribute("style"),modalImg.appendChild(e),console.log(e),modal.style.display="block",voucherCanvas=e.toDataURL()})}function displayVoucher(e){e.preventDefault();const o={Name:Name,Amount:Amount,Currency:Currency,Batch:Batch,Date:date,"Serial-Number":SerialNumber,Remark:formRemark.value};SubmitBtn.innerText="Sending...",SubmitBtn.disable=!0,voucherName.innerHTML=Name,voucherDate.innerHTML=date,voucherSN.innerHTML=SerialNumber,voucherAmount.innerHTML=Amount+" ( "+addCurrency()+" )",voucher.style.display="block",screenshot(),voucher.style.display="none",formContent.reset(),fetch(url,{method:"POST",cache:"no-cache",redirect:"follow",body:JSON.stringify(o)}).then(e=>e.json()).then(e=>{console.log(e),checkContent.style.display="none",document.querySelector(".l-form").style.display="none",document.querySelector(".modal__success").style.display="block",window.setTimeout(()=>{document.querySelector(".modal__success").style.display="none"},3e3),SubmitBtn.innerHTML="Submit",SubmitBtn.disable=!1}).catch(e=>{console.log(e),console.log("Something Went Wrong"),document.querySelector(".modal__error").style.display="block",window.setTimeout(()=>{document.querySelector(".modal__error").style.display="none"},3e3)})}function addCurrency(){return"MMK"===Currency?"KYAT":"USD"===Currency?"USD":"JPY"===Currency?"YEN":"SGD"===Currency?"SGD":"THB"===Currency?"Baht":"CNY"===Currency?"YUAN":"Euro"}function downloadImg(e){e.preventDefault(),console.log("Download Voucher");const o=document.createElement("a");o.download="download.png",o.href=voucherCanvas,o.click(),o.delete,modal.style.display="none",modalImg.innerHTML="",formContent.style.display="block",document.querySelector(".footer").style.display="block",document.querySelector(".l-form").style.display="block"}formContent.addEventListener("submit",displayCheck),EditBtn.addEventListener("click",displayForm),SubmitBtn.addEventListener("click",displayVoucher),download.addEventListener("click",downloadImg);